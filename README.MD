# ğŸŸ¢ Tradewatch Bot

A robust and production-grade trading bot built with **Node.js** that:

- Monitors a **Google Sheets** spreadsheet for new trade entries  
- Sends **automated trade cards** to a specific **Telegram topic**  
- Monitors live prices via the **Bybit API**  
- Automatically updates trade statuses with stop-loss and target logic  

---

## âœ… Features
- **Google Sheets Integration**  
  Reads and updates spreadsheet data in real time using a **Service Account** (no OAuth needed).

- **Telegram Integration**  
  Sends trade alerts, updates, and closures to a **forum topic inside a Telegram supergroup**.

- **Live Price Monitoring**  
  Continuously polls **Bybit** for market price updates to trigger targets and stop-loss events.

- **Persistent Tracking**  
  Prevents duplicate messages using local JSON caches (`sent_trades.json`, `processed_trades.json`).

- **Resilience & Retry**  
  Uses exponential backoff + jitter for all API calls to handle rate limits and connection errors gracefully.

---

## ğŸ›  Tech Stack
- Node.js
- Google Sheets API (via Service Account)
- Telegram Bot API (`node-telegram-bot-api`)
- Bybit API
- Docker + Docker Compose
- PM2 Runtime

---

## âš™ï¸ Environment Variables
Create a `.env` file in the root directory with the following variables:

```env
# Path to your Service Account credentials JSON
GOOGLE_CREDENTIALS_PATH=./secrets/tradewatch-key.json

# ID of the Google Spreadsheet to monitor
SPREADSHEET_ID=your_google_sheet_id_here

# Telegram bot token
TELEGRAM_TOKEN=your_telegram_bot_token_here

# Telegram group or channel ID
TELEGRAM_CHAT_ID=-100xxxxxxxxxx

# Telegram topic/thread ID (optional)
TELEGRAM_TOPIC_ID=123456

# Bybit API URL (optional override)
BYBIT_BASE_URL=https://api.bybit.com/v5/market/tickers?category=linear&symbol=
```

ğŸ” **Important:** Ensure the Google Sheet is shared with the Service Account email (xxx@project.iam.gserviceaccount.com).

---

## ğŸ“ File Structure
tradewatch-bot/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ index.js              # Main bot logic
â”‚   â””â”€â”€ sheets.js             # Google Sheets wrapper (Service Account auth)
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ sent_trades.json      # JSON cache of sent trades
â”‚â”€â”€ secrets/
â”‚   â””â”€â”€ tradewatch-key.json   # Service Account JSON (excluded from Git)
â”œâ”€â”€ .env                      # Environment variables
â”œâ”€â”€ Dockerfile                # Docker build config
â”œâ”€â”€ docker-compose.yml        # Docker service config
â”œâ”€â”€ ecosystem.config.js       # PM2 process manager config
â”œâ”€â”€ package.json              # Project metadata
â””â”€â”€ README.md                 # This file

---

## ğŸ§ª Running Locally
```bash
# Clone the repo
git clone https://github.com/YOUR_USER/tradewatch-bot.git
cd tradewatch-bot

# Install dependencies
npm install

# Run the bot
node src/index.js
```
---

## ğŸ³ Running with Docker
```bash
# Build and start the container in detached mode
docker-compose up -d --build

# View logs
docker logs -f tradewatch
```

---

## ğŸ©º Healthcheck
The bot exposes a healthcheck endpoint at:

http://<your-ip>:3000/health

---

## ğŸ‘¨â€ğŸ’» Author
Igor Souza
GitHub: @frontdev1254


## ğŸ“ License
This project is licensed under the MIT License. See LICENSE for details.